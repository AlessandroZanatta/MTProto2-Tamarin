

  lemma LemmaRekeyingInitiatorSendsHalfKey:
    exists-trace
    "
      ∃ iUser rUser eID g_i #i.
        InitiatorSendsHalfKey(eID, iUser, rUser, g_i) @i ∧
        ¬(∃ x #r. RegisteredSessionKey(x) @r) ∧
        ¬(∃ x #r. CompromisedRekeyingInitiatorEphemeralKey(x) @r) ∧
        ¬(∃ x #r. CompromisedRekeyingResponderEphemeralKey(x) @r)
    "

  lemma LemmaRekeyingResponderReceivesHalfKey:
    exists-trace
    "
      ∃ iUser rUser eID g_i #i.
        ResponderReceivesHalfKey(eID, iUser, rUser, g_i) @i ∧
        ¬(∃ x #r. RegisteredSessionKey(x) @r) ∧
        ¬(∃ x #r. CompromisedRekeyingInitiatorEphemeralKey(x) @r) ∧
        ¬(∃ x #r. CompromisedRekeyingResponderEphemeralKey(x) @r)
    "

  lemma LemmaRekeyingResponderSendsHalfKey:
    exists-trace
    "
      ∃ iUser rUser eID g_r fp #i.
        ResponderSendsHalfKey(eID, iUser, rUser, g_r, fp) @i ∧
        ¬(∃ x #r. RegisteredSessionKey(x) @r) ∧
        ¬(∃ x #r. CompromisedRekeyingInitiatorEphemeralKey(x) @r) ∧
        ¬(∃ x #r. CompromisedRekeyingResponderEphemeralKey(x) @r)
    "

  lemma LemmaRekeyingInitiatorReceivesHalfKey:
    exists-trace
    "
      ∃ iUser rUser eID g_r fp #i.
        InitiatorReceivesHalfKey(eID, iUser, rUser, g_r, fp) @i ∧
        ¬(∃ x #r. RegisteredSessionKey(x) @r) ∧
        ¬(∃ x #r. CompromisedRekeyingInitiatorEphemeralKey(x) @r) ∧
        ¬(∃ x #r. CompromisedRekeyingResponderEphemeralKey(x) @r)
    "
  
  lemma LemmaRekeyingRekeyingKeyFingerprintMatches:
    exists-trace
    "
      ∃ iUser rUser eID fp1 fp2 #i.
        RekeyingKeyFingerprintMatches(eID, iUser, rUser, fp1, fp2) @i ∧
        ¬(∃ x #r. RegisteredSessionKey(x) @r) ∧
        ¬(∃ x #r. CompromisedRekeyingInitiatorEphemeralKey(x) @r) ∧
        ¬(∃ x #r. CompromisedRekeyingResponderEphemeralKey(x) @r)
    "

  lemma LemmaRekeyingInitiatorHasNegotiatedNewKey:
    exists-trace
    "
      ∃ iUser rUser eID newKey #i.
        InitiatorHasNegotiatedNewKey(eID, iUser, rUser, newKey) @i ∧
        ¬(∃ x #r. RegisteredSessionKey(x) @r) ∧
        ¬(∃ x #r. CompromisedRekeyingInitiatorEphemeralKey(x) @r) ∧
        ¬(∃ x #r. CompromisedRekeyingResponderEphemeralKey(x) @r)
    "

  lemma LemmaRekeyingInitiatorSendsAck:
    exists-trace
    "
      ∃ iUser rUser eID fp #i.
        InitiatorSendsAck(eID, iUser, rUser, fp) @i ∧
        ¬(∃ x #r. RegisteredSessionKey(x) @r) ∧
        ¬(∃ x #r. CompromisedRekeyingInitiatorEphemeralKey(x) @r) ∧
        ¬(∃ x #r. CompromisedRekeyingResponderEphemeralKey(x) @r)
    "

  lemma LemmaRekeyingResponderReceivesAck:
    exists-trace
    "
      ∃ iUser rUser eID fp #i.
        ResponderReceivesAck(eID, iUser, rUser, fp) @i ∧
        ¬(∃ x #r. RegisteredSessionKey(x) @r) ∧
        ¬(∃ x #r. CompromisedRekeyingInitiatorEphemeralKey(x) @r) ∧
        ¬(∃ x #r. CompromisedRekeyingResponderEphemeralKey(x) @r)
    "

  lemma LemmaRekeyingResponderHasNegotiatedNewKey:
    exists-trace
    "
      ∃ iUser rUser eID newKey #i.
        ResponderHasNegotiatedNewKey(eID, iUser, rUser, newKey) @i ∧
        ¬(∃ x #r. RegisteredSessionKey(x) @r) ∧
        ¬(∃ x #r. CompromisedRekeyingInitiatorEphemeralKey(x) @r) ∧
        ¬(∃ x #r. CompromisedRekeyingResponderEphemeralKey(x) @r)
    "
  
  lemma LemmaRekeyingClientSendsMessageWithNewKey:
    exists-trace
    "
      ∃ sender iUser rUser xID exchangeID newKey msg #i.
        ClientSendsMessageWithNewKey(xID, sender, exchangeID, iUser, rUser, newKey, msg) @i ∧
        ¬(∃ x #r. RegisteredSessionKey(x) @r) ∧
        ¬(∃ x #r. CompromisedRekeyingInitiatorEphemeralKey(x) @r) ∧
        ¬(∃ x #r. CompromisedRekeyingResponderEphemeralKey(x) @r)
  "

  lemma LemmaRekeyingClientReceivesMessageWithNewKey:
    exists-trace
    "
      ∃ receiver iUser rUser xID exchangeID newKey msg #i.
        ClientReceivesMessageWithNewKey(xID, receiver, exchangeID, iUser, rUser, newKey, msg) @i ∧
        ¬(∃ x #r. RegisteredSessionKey(x) @r) ∧
        ¬(∃ x #r. CompromisedRekeyingInitiatorEphemeralKey(x) @r) ∧
        ¬(∃ x #r. CompromisedRekeyingResponderEphemeralKey(x) @r)
  "

  lemma LemmaRekeyingCompromisedRekeyingInitiatorEphemeralKey:
    exists-trace
    "∃ x #i. CompromisedRekeyingInitiatorEphemeralKey(x) @i"

  lemma LemmaRekeyingCompromisedRekeyingResponderEphemeralKey:
    exists-trace
    "∃ x #i. CompromisedRekeyingResponderEphemeralKey(x) @i"

  lemma AdversayCanImpersonateResponder1:
    exists-trace
    "∃ eID iUser g_i #i.
      InitiatorSendsHalfKey(eID, iUser, 'Eve', g_i) @i ∧
      ¬(∃ x #r. CompromisedRekeyingInitiatorEphemeralKey(x) @r) ∧
      ¬(∃ x #r. CompromisedRekeyingResponderEphemeralKey(x) @r)
    "

  lemma AdversaryCanImpersonateResponder2:
    exists-trace
    "∃ eID rUser g_i #i.
      ResponderReceivesHalfKey(eID, 'Eve', rUser, g_i) @i ∧
      ¬(∃ x #r. CompromisedRekeyingInitiatorEphemeralKey(x) @r) ∧
      ¬(∃ x #r. CompromisedRekeyingResponderEphemeralKey(x) @r)
    "

  lemma AdversayCanImpersonateResponder3:
    exists-trace
    "∃ eID iUser fp #i.
      InitiatorSendsAck(eID, iUser, 'Eve', fp) @i ∧
      ¬(∃ x #r. CompromisedRekeyingInitiatorEphemeralKey(x) @r) ∧
      ¬(∃ x #r. CompromisedRekeyingResponderEphemeralKey(x) @r)
    "

  lemma AdversaryCanImpersonateResponder4:
    exists-trace
    "∃ eID rUser fp #i.
      ResponderReceivesAck(eID, 'Eve', rUser, fp) @i ∧
      ¬(∃ x #r. CompromisedRekeyingInitiatorEphemeralKey(x) @r) ∧
      ¬(∃ x #r. CompromisedRekeyingResponderEphemeralKey(x) @r)
    "

  